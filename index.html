<script>
        // CONFIGURAÇÕES
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxFa3Ym6ByJVldODGr6bqLdS5Iuj1UoF1HzymktJgRZFjOO6NqnT9uivM1RrhXBwSk/exec';
        const SENHA_MESTRA = "fornalle2025"; // MUDE SUA SENHA AQUI!
        let premioAtual = "";

        window.onload = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const p = urlParams.get('p');

            if (p) {
                // MODO CLIENTE (Link com prêmio)
                document.getElementById('painel-admin').style.display = 'none';
                document.getElementById('tela-cadastro').style.display = 'flex';
                try {
                    premioAtual = decodeURIComponent(escape(atob(p)));
                } catch(e) {
                    alert("Link inválido!");
                }
            } else {
                // MODO ADMIN (Link puro)
                verificarLogin();
            }
        };

        function verificarLogin() {
            const senhaDigitada = prompt("ACESSO RESTRITO: Digite a senha da Fornalle:");
            
            if (senhaDigitada === SENHA_MESTRA) {
                document.getElementById('painel-admin').style.display = 'flex';
                alert("Acesso autorizado!");
            } else {
                alert("Senha incorreta!");
                window.location.href = "https://www.google.com"; // Expulsa o intruso
            }
        }

        // ... Mantenha as outras funções (prepararLink, finalizarCadastro, etc) como estavam ...
        
        function prepararLink(premio) {
            const urlBase = window.location.href.split('?')[0];
            const codigo = btoa(unescape(encodeURIComponent(premio)));
            document.getElementById('caixa-link').innerText = urlBase + "?p=" + codigo;
        }

        function copiarLink() {
            const texto = document.getElementById('caixa-link').innerText;
            if(texto.includes("Selecione")) return alert("Escolha um prêmio!");
            navigator.clipboard.writeText(texto);
            alert("Link copiado!");
        }

        function abrirModal() { document.getElementById('meuModal').style.display = 'flex'; }
        function fecharModal() { document.getElementById('meuModal').style.display = 'none'; }

        function finalizarCadastro() {
            const nome = document.getElementById('nome').value;
            const cpf = document.getElementById('cpf').value;
            const whats = document.getElementById('whats').value;
            if(!nome || !cpf || !whats) return alert("Preencha tudo!");

            const finalURL = `${scriptURL}?nome=${encodeURIComponent(nome)}&cpf=${encodeURIComponent(cpf)}&whatsapp=${encodeURIComponent(whats)}&premio=${encodeURIComponent(premioAtual)}`;
            
            fetch(finalURL, { mode: 'no-cors' }).then(() => {
                document.getElementById('tela-cadastro').style.display = 'none';
                document.getElementById('tela-cliente').style.display = 'flex';
                document.getElementById('premio-texto').innerText = premioAtual;
                iniciarRaspadinha();
            });
        }

        function iniciarRaspadinha() {
            const canvas = document.getElementById('scratchCanvas');
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#a0a0a0'; ctx.fillRect(0,0,300,300);
            ctx.fillStyle = 'black'; ctx.font = 'bold 30px Oswald'; ctx.textAlign = 'center';
            ctx.fillText('RASPE AQUI!', 150, 160);

            let isDrawing = false;
            const draw = (e) => {
                if(!isDrawing) return;
                const rect = canvas.getBoundingClientRect();
                const x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
                const y = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;
                ctx.globalCompositeOperation = 'destination-out';
                ctx.beginPath(); ctx.arc(x, y, 35, 0, Math.PI*2); ctx.fill();
            };
            canvas.onmousedown = () => isDrawing = true; canvas.onmouseup = () => isDrawing = false; canvas.onmousemove = draw;
            canvas.ontouchstart = (e) => { isDrawing = true; e.preventDefault(); }; canvas.ontouchend = () => isDrawing = false; canvas.ontouchmove = draw;
        }
    </script>